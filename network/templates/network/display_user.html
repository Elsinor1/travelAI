{% extends "network/layout.html" %}
{% load static %}

{% block body %}
    <script src="{% static 'network/display_user.js' %}"></script>

    <div class="d-flex flex-wrap justify-content-between">
        <!-- Profile  -->
        <div id="profile" class="d-flex">
            <div id="profile-header">
                <h3>{{ displayed_user.username }}</h3>
                {% if displayed_user != request.user %}
                    <button id="follow-btn" class="btn btn-secondary" data-user_id='{{ displayed_user.id }}'>Follow</button>
                {% endif %}
                <h5 id="follows">Follows: {{ displayed_user.following.all.count }} user(s)</h5>
                <h5 id="followed_by">Is followed by: {{ displayed_user.followed_by.all.count }} user(s)</h5>
            </div>
        </div>

        <div>
            <!-- PAGINATION NAVIGATION -->
            <div class="pagination">
                <span class="step-links">
                    {% if page_obj.has_previous %}
                        <a href="?page=1">&laquo; first</a>
                        <a href="?page={{ page_obj.previous_page_number }}">previous</a>
                    {% endif %}

                    <span class="current">
                        Page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}.
                    </span>

                    {% if page_obj.has_next %}
                        <a href="?page={{ page_obj.next_page_number }}">next</a>
                        <a href="?page={{ page_obj.paginator.num_pages }}">last &raquo;</a>
                    {% endif %}
                </span>
            </div>

            <!-- Posts -->
            <div id="content-following">
                {% for post in page_obj %}
                    <div class="post-container" id="post_{{post.id}}">
                        <div class="post-header d-flex justify-content-between align-items-center">
                            <h4><a href= "{% url 'display_user' user_id=post.author.id %}">{{ post.author.username }}</a></h4>
                            <h5>{{ post.date }}</h5>

                            <div class="like-container d-flex align-items-center">
                                <h5>Likes:</h5>
                                <h5 class="likes" id="likes_{{ post.id }}">{{ post.likes.count }}</h5>
                                {% if request.user.is_authenticated and request.user != post.author %}
                                    <button class="like-button btn btn-secondary" id="like_button_{{ post.id }}">
                                        {% if post in liked_post_query %}
                                            Unlike
                                            <i class="fa fa-thumbs-down"></i>
                                        {% else %}
                                            Like
                                            <i class="fa fa-thumbs-up"></i>
                                        {% endif %}
                                    </button>
                                {% endif %}

                                {% if post.author == request.user %}
                                    <button class="edit-post btn btn-secondary" id="edit_button_{{ post.id }}">Edit Post</button>
                                {% endif %}
                            </div>
                        </div>
                        <p class="post-text"id="post_text_{{ post.id }}">{{ post.text }}</p>
                    </div>
                {% endfor %}



            <!-- PAGINATION NAVIGATION -->
            <div class="pagination">
                <span class="step-links">
                    {% if page_obj.has_previous %}
                        <a href="?page=1">&laquo; first</a>
                        <a href="?page={{ page_obj.previous_page_number }}">previous</a>
                    {% endif %}

                    <span class="current">
                        Page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}.
                    </span>

                    {% if page_obj.has_next %}
                        <a href="?page={{ page_obj.next_page_number }}">next</a>
                        <a href="?page={{ page_obj.paginator.num_pages }}">last &raquo;</a>
                    {% endif %}
                </span>
            </div>
         </div>
        </div>
    </div>
{% endblock %}
